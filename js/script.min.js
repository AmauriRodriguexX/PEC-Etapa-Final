const $videoModal=document.getElementById("video-modal"),$videoSource=document.getElementById("player");var player,tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);let videoPlayStatus={},percentageSended={},intervalId,hasBeenPaused=!1;function getYoutubeVideoId(e){let t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/|youtube\.com\/embed\/)([^"&?\/\s]{11})/);return t&&t[1]?t[1]:null}function onPlayerReady(e){percentageSended={}}function getNearestVideoPercentage(e){let t=[10,25,50,75],a=t[0],r=Math.abs(e-t[0]);for(let n=1;n<t.length;n++){let o=Math.abs(e-t[n]);o<r&&(r=o,a=t[n])}return a}function checkVideoProgress(){let e=player.getCurrentTime(),t=player.getDuration();if(void 0!==e&&0!==t)switch(Math.round(e/t*100)){case 10:10 in percentageSended||(percentageSended[10]=!1),percentageSended[10]||(percentageSended[10]=!0,sendVideoProgressEvent(10));break;case 25:25 in percentageSended||(percentageSended[25]=!1),percentageSended[25]||(percentageSended[25]=!0,sendVideoProgressEvent(25));break;case 50:50 in percentageSended||(percentageSended[50]=!1),percentageSended[50]||(percentageSended[50]=!0,sendVideoProgressEvent(50));break;case 75:75 in percentageSended||(percentageSended[75]=!1),percentageSended[75]||(percentageSended[75]=!0,sendVideoProgressEvent(75))}}function onPlayerStateChange(e){let t=document.getElementById("player"),a=getYoutubeVideoId(t.src),r=t.getAttribute("competitor-index"),n=t.getAttribute("group-name");if(currentGroupData[r],a in videoPlayStatus||(videoPlayStatus[a]=!1,onVideoStart(n,t.src)),e.data==YT.PlayerState.PLAYING)hasBeenPaused=!1,clearInterval(intervalId),intervalId=setInterval(checkVideoProgress,50),videoPlayStatus[a]||(videoPlayStatus[a]=!0);else if(e.data==YT.PlayerState.PAUSED){hasBeenPaused=!0,clearInterval(intervalId);let o=player.getCurrentTime()/player.getDuration()*100;sendVideoProgressEvent(o)}else e.data==YT.PlayerState.ENDED&&(clearInterval(intervalId),percentageSended={},videoPlayStatus[a]=!1,onVideoCompletion(n,t.src))}const openModal=(e,t,a,r,n)=>{$videoModal&&$videoSource&&($videoModal.style.display="block",$videoSource.setAttribute("competitor-index",r),$videoSource.setAttribute("group-name",n),onKnowTheStory(t,buildYoutubeEmbedLink(e))),player&&player.destroy(),player=new YT.Player("player",{videoId:e,playerVars:{rel:0},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})},closeModal=()=>{if($videoModal){clearInterval(intervalId),$videoModal.style.display="none";let e=player.getCurrentTime()/player.getDuration()*100;e<90&&e>0&&!hasBeenPaused&&sendVideoProgressEvent(e),player.destroy()}},sendVideoProgressEvent=e=>{let t=document.getElementById("player");t.getAttribute("competitor-index");let a=t.getAttribute("group-name");onVideoPause(a,getNearestVideoPercentage(e),t.src)};window.onclick=e=>{e.target===$videoModal&&closeModal("click fuera")};const carousel=document.querySelector(".carousel");let isDragging=!1,startX,scrollLeft;const goToCB=()=>{window.location.href="https://www.compartamos.com.mx/compartamos"},goToAbout=()=>{window.location.href="acerca-de.html"},goToWinners=()=>{window.location.href="ganadores.html"};document.getElementById("hamburger-icon").addEventListener("click",function(){this.classList.toggle("active"),document.getElementById("mobile-nav").classList.toggle("active")}),carousel.addEventListener("mousedown",e=>{isDragging=!0,startX=e.pageX-carousel.offsetLeft,scrollLeft=carousel.scrollLeft}),carousel.addEventListener("touchstart",e=>{isDragging=!0,startX=e.touches[0].clientX-carousel.offsetLeft,scrollLeft=carousel.scrollLeft}),carousel.addEventListener("mouseup",()=>{isDragging=!1}),carousel.addEventListener("touchend",()=>{isDragging=!1}),carousel.addEventListener("mousemove",e=>{if(!isDragging)return;e.preventDefault();let t=e.pageX-carousel.offsetLeft,a=(t-startX)*3;carousel.scrollLeft=scrollLeft-a}),carousel.addEventListener("touchmove",e=>{if(!isDragging)return;e.preventDefault();let t=e.touches[0].clientX-carousel.offsetLeft,a=(t-startX)*3;carousel.scrollLeft=scrollLeft-a}),document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll(".carousel-button");e[0].classList.add("selected"),e.forEach(t=>{t.addEventListener("click",function(){e.forEach(e=>e.classList.remove("selected")),t.classList.add("selected")})})});const groups={Participacion_familiar:[{number:"1",name:"Martha \xc1valos",image:"./assets/images/categorias/categoria-participacion.png",alt:"Martha \xc1valos ganadora de la categor\xeda de participaci\xf3n del Premio Emprendedores 2024",description:"Su historia es un ejemplo de emprendimiento y uni\xf3n familiar, a trav\xe9s de su negocio Martha inspira a muchas familias a luchar por sus sue\xf1os.",videoId:"XpRbNw1Nmgo"}],ProducciÃ³n:[{number:"2",name:"Julio Molina",image:"./assets/images/categorias/categoria-produccion.png",alt:"Julio Molina ganador de la categor\xeda de producci\xf3n del Premio Emprendedores 2024.",description:"Su historia nos confirma que el \xe9xito de un negocio se basa en la convicci\xf3n de creer que los sue\xf1os se pueden cumplir.",videoId:"-wXfRtdUmHU"}],Servicio:[{number:"3",name:"Patricia Beltr\xe1n",image:"./assets/images/categorias/categoria-servicio.png",alt:"Patricia Beltr\xe1n ganadora de la categor\xeda de servicio del Premio Emprendedores 2024.",description:"Su historia\xa0es un ejemplo\xa0de servicio c\xe1lido y de excelencia. Patricia nos comparte la pasi\xf3n que siente al atender a sus clientes y el amor que pone en cada platillo que prepara.",videoId:"vPT6wT2dExs"}],Comercio:[{number:"4",name:"Divvani Liz\xe1rraga",image:"./assets/images/categorias/categoria-comercio.png",alt:"Divvani Liz\xe1rraga ganadora de la categor\xeda de comercio del Premio Emprendedores 2024.",description:"Su historia es un ejemplo de perseverancia y trabajo en equipo para lograr un negocio exitoso. Divanni nos inspira a siempre dar un extra.",videoId:"-AgdijCss_c"}]};var currentGroupData=[];function handleCompetitorClick(e,t,a,r,n,o,s){openModal(e,t,a,r,n),registrarEventoGanadoresPECCategoriasEspeciales(r+1,n,o,s)}document.addEventListener("DOMContentLoaded",async function(){let e=document.querySelectorAll(".carousel-button"),t=document.getElementById("prev-group-button"),a=document.getElementById("next-group-button"),r=0,n=document.querySelector(".competitor-group");function o(){e.forEach(e=>e.classList.remove("selected")),e[r].classList.add("selected"),updateCarouselArrow(r)}function s(e,t,a,r,o=!0){n.innerHTML="",a.forEach((t,a)=>{let r=`https://www.youtube.com/embed/${t.videoId}`,s=t.image;n.innerHTML+=`
        <div class="competitor">
          <div class="competitor-img" onclick="handleCompetitorClick('${t.videoId}', '${t.name}', '${t.description}', '${a}', '${e}', '${s}', '${r}');">
            <img src="${s}" alt="${t.alt}" width="150" height="60" />
          </div>
        </div>
        <div class="actions">
          <div class="history">
            <p class="competitor-name" onclick="handleCompetitorClick('${t.videoId}', '${t.name}', '${t.description}', '${a}', '${e}', '${s}', '${r}');">
              ${t.name}
            </p>
            <p class="competitor-group-name">${e}</p>
            <p id="competitor-description" class="description">${t.description}</p>
            <div class="button-container" 
              onclick="handleCompetitorClick('${t.videoId}', '${t.name}', '${t.description}', '${a}', '${e}', '${s}', '${r}');">
              <button class="watch-video">
                <p>Conoce su historia</p>
                <div class="play-button"><img src="./assets/images/play-video.png" alt="bubble" /></div>
              </button>
            </div>
          </div> 
        </div>
      `,o&&registrarEventoVerFoto(s);let l=document.querySelectorAll("#competitor-description"),i=0;l.forEach(e=>{e.offsetHeight>i&&(i=e.offsetHeight)}),l.forEach(e=>{e.style.height=i+"px"})})}currentGroupData=[],s(e[0].textContent,0,groups[e[0].getAttribute("data-group")],!1),e.forEach((t,a)=>{let r=t.getAttribute("data-group");t.addEventListener("click",function(){e.forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),currentGroupData=groups[r],s(t.textContent,a+1,groups[r],!1)})}),updateCarouselArrow(0),t.addEventListener("click",function(){r=r>0?r-1:e.length-1,o(),s(e[r].textContent,r+1,groups[e[r].getAttribute("data-group")],!1,!1)}),a.addEventListener("click",function(){r=r<e.length-1?r+1:0,o(),s(e[r].textContent,r+1,groups[e[r].getAttribute("data-group")],!1,!1)})});const $carouselLeftArrow=document.getElementById("prev-group-button"),$carouselRightArrow=document.getElementById("next-group-button");$carouselLeftArrow&&$carouselLeftArrow.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),currentIndex=currentIndex>0?currentIndex-1:buttons.length-1,updateSelectedButton(),updateGroupContent(buttons[currentIndex].textContent,currentIndex+1,groups[buttons[currentIndex].getAttribute("data-group")],!1,!1)}),$carouselRightArrow&&$carouselRightArrow.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),currentIndex=(currentIndex+1)%buttons.length,updateSelectedButton(),updateGroupContent(buttons[currentIndex].textContent,currentIndex+1,groups[buttons[currentIndex].getAttribute("data-group")],!1,!1)}),$carouselLeftArrow&&$carouselLeftArrow.addEventListener("click",function(e){e.preventDefault(),console.log("Bot\xf3n de flecha izquierda presionado")}),$carouselRightArrow&&$carouselRightArrow.addEventListener("click",function(e){e.preventDefault(),console.log("Bot\xf3n de flecha derecha presionado")});const updateCarouselArrow=e=>{0==e?($carouselLeftArrow.classList.remove("active"),$carouselLeftArrow.classList.add("inactive")):($carouselLeftArrow.classList.remove("inactive"),$carouselLeftArrow.classList.add("active")),e==Object.keys(groups).length-1?($carouselRightArrow.classList.remove("active"),$carouselRightArrow.classList.add("inactive")):($carouselRightArrow.classList.remove("inactive"),$carouselRightArrow.classList.add("active"))};function share(e){let t=encodeURIComponent(window.location.href);switch(url="",e){case"Facebook":url=`https://www.facebook.com/sharer/sharer.php?u=${t}`;break;case"Whatsapp":url=`https://wa.me/?text=${t}`}url&&window.open(url,"_blank")}let currentIndex=0;const $galleryItems=document.querySelectorAll(".gallery-item img"),$modalViewGallery=document.getElementById("gallery-view-modal"),$fullGallery=document.getElementById("gallery-modal"),$imageCount=document.getElementById("image-count"),$modalImg=document.getElementById("gallery-image"),$leftArrow=document.getElementById("left-arrow"),$rightArrow=document.getElementById("right-arrow");let totalImages=$galleryItems.length;$imageCount.textContent=`${totalImages}`,document.querySelectorAll(".gallery-item img").forEach((e,t)=>{e.addEventListener("click",function(){openModalGallery(this.src,t)})});const openModalGallery=(e,t)=>{onGallery(e),currentIndex=t;let a=document.getElementById("gallery-image");updateImageIndex(),a.src=e,$modalViewGallery.style.display="block",updateGalleryArrow(t)},closeModalGallery=()=>{$modalViewGallery&&($modalViewGallery.style.display="none")},openFullGallery=()=>{window.location.href="galeria.html"},closeFullGallery=()=>{$fullGallery&&($fullGallery.style.display="none")};function updateImageIndex(){let e=document.getElementById("imageIndex");e.textContent=`${currentIndex+1} / ${totalImages}`,updateGalleryArrow(currentIndex)}const prevImage=()=>{onGallery($galleryItems[currentIndex=currentIndex>0?currentIndex-1:totalImages-1].src),$modalImg.src=$galleryItems[currentIndex].src,updateImageIndex()},nextImage=()=>{onGallery($galleryItems[currentIndex=currentIndex<totalImages-1?currentIndex+1:0].src),$modalImg.src=$galleryItems[currentIndex].src,updateImageIndex()},updateGalleryArrow=e=>{0==e?($leftArrow.classList.remove("active"),$leftArrow.classList.add("inactive")):($leftArrow.classList.remove("inactive"),$leftArrow.classList.add("active")),e==totalImages-1?($rightArrow.classList.remove("active"),$rightArrow.classList.add("inactive")):($rightArrow.classList.remove("inactive"),$rightArrow.classList.add("active"))};function getFullImageUrl(e){if(!e)return null;let t=window.location.origin;return new URL(e.replace("./",""),t).href}const formatDuration=e=>{let t=Math.floor(e/60),a=Math.floor(e%60),r=String(t).padStart(2,"0"),n=String(a).padStart(2,"0");return`${r}:${n}`},calculateScrollPercentage=()=>{let e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.scrollHeight||document.body.scrollHeight,a=document.documentElement.clientHeight,r=t-a,n=Math.floor(e/r*100);return n},combineObjects=e=>e.reduce((e,t)=>({...e,...t}),{}),saveToLocalStorage=(e,t)=>{let a=JSON.stringify(t);window.localStorage.setItem(e,a)},retrieveFromLocalStorage=e=>{let t=window.localStorage.getItem(e);return t?JSON.parse(t):null};function buildYoutubeEmbedLink(e){return"https://www.youtube.com/embed/"+e}const GALLERY_IMAGES=["./assets/images/gallery-1.png","./assets/images/gallery-2.png","./assets/images/gallery-3.png","./assets/images/gallery-4.png","./assets/images/gallery-5.png","./assets/images/gallery-6.png","./assets/images/gallery-7.png","./assets/images/gallery-8.png","./assets/images/gallery-9.png","./assets/images/gallery-10.png","./assets/images/gallery-11.png","./assets/images/gallery-12.png","./assets/images/gallery-13.png","./assets/images/gallery-14.png","./assets/images/gallery-15.png","./assets/images/gallery-16.png","./assets/images/gallery-17.png","./assets/images/gallery-18.png","./assets/images/gallery-19.png","./assets/images/gallery-20.png","./assets/images/gallery-21.png","./assets/images/gallery-22.png","./assets/images/gallery-23.png","./assets/images/gallery-24.png","./assets/images/gallery-25.png","./assets/images/gallery-26.png","./assets/images/gallery-27.png","./assets/images/gallery-28.png","./assets/images/gallery-29.png","./assets/images/gallery-30.png",],$GALLERY_MODAL=document.getElementById("gallery-modal"),$GALLERY_IMAGE=document.getElementById("gallery-image"),$CLOSE_GALLERY=document.getElementById("close_modal"),$PREV_BUTTON=document.querySelector(".prev"),$NEXT_BUTTON=document.querySelector(".next"),$GALLERY_COUNTER=document.getElementById("counter-number"),$GALLERY_SHARE=document.getElementById("gallery-share"),$SHARE_DROPDOWN=document.getElementById("share-dropdown");function download(){let e=getFullImageUrl(GALLERY_IMAGES[currentIndex]);if(!e){alert("No se encontr\xf3 la URL de la imagen.");return}try{let t=createDownloadLink(e);onGalleryDownload(e),t.click()}catch(a){console.error("Error al descargar la imagen:",a),alert("No se pudo descargar la imagen. Int\xe9ntalo m\xe1s tarde.")}}function createDownloadLink(e){let t=document.createElement("a");return t.href=e,t.download=extractFileName(e),t}function extractFileName(e){return e.substring(e.lastIndexOf("/")+1)}function getCurrentImageUrl(e){return GALLERY_IMAGES[e]||null}async function share(){try{let e=getCurrentImageUrl(currentIndex),t=await fetchImageBlob(e),a=createFileFromBlob(t,e);await isShareSupported(a)?(await navigator.share({title:"Imagen de la galeria.",files:[a]}),onGalleryShare(e)):openShareDropdown($SHARE_DROPDOWN,$GALLERY_SHARE)}catch(r){console.error("Error al compartir imagen:",r)}}async function fetchImageBlob(e){let t=await fetch(e);if(!t.ok)throw Error(`Error al recuperar la imagen: ${t.statusText}`);return await t.blob()}function createFileFromBlob(e,t){let a=extractFileExtension(t),r=getMimeType(a),n=`imagen.${a}`;return new File([e],n,{type:r})}function extractFileExtension(e){return e.split(".").pop().toLowerCase()}function getMimeType(e){return({jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp"})[e]||"application/octet-stream"}async function isShareSupported(e){return navigator.canShare&&navigator.canShare({files:[e]})}function openShareDropdown(e,t){displayShareDropdown(e),setGalleryShareStyles(t)}function closeShareDropdown(e,t){hideShareDropdown(e),unsetGalleryShareStyles(t)}function displayShareDropdown(e){e&&(e.style.display="block")}function hideShareDropdown(e){e&&(e.style.display="none")}function setGalleryShareStyles(e){e&&(e.style.borderRadius="34.5px 34.5px 0 34.5px")}function unsetGalleryShareStyles(e){e&&(e.style.borderRadius="34.5px")}function handleOutsideClick(e,t,a){e.target.closest(".share_wrapper")||e.target.matches(".share-dropdown")||closeShareDropdown(t,a)}function bindOutsideClick(e,t){window.addEventListener("click",a=>handleOutsideClick(a,e,t))}function shareInFacebook(e=currentIndex){shareOnPlatform(e,"https://www.facebook.com/sharer/sharer.php?u=")}function shareInWhatsapp(e=currentIndex){shareOnPlatform(e,"https://wa.me/?text=")}function shareOnPlatform(e,t){let a=getCurrentImageUrl(e),r=getFullImageUrl(a),n=t+encodeURIComponent(r);window.open(n,"_blank")}document.addEventListener("DOMContentLoaded",function(){$SHARE_DROPDOWN&&$GALLERY_SHARE&&bindOutsideClick($SHARE_DROPDOWN,$GALLERY_SHARE)});